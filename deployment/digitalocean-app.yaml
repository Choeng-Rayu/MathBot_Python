name: mathbot-telegram
services:
- name: mathbot-api
  source_dir: /
  github:
    repo: YOUR_GITHUB_USERNAME/MathBot_Python
    branch: main
    deploy_on_push: true

  # Build configuration
  build_command: pip install --upgrade pip && pip install -r requirements.txt

  # Runtime configuration
  run_command: python main.py

  # Environment configuration
  environment_slug: python
  instance_count: 1
  instance_size_slug: basic-xxs
  
  # Health check
  health_check:
    http_path: /health
    initial_delay_seconds: 30
    period_seconds: 10
    timeout_seconds: 5
    success_threshold: 1
    failure_threshold: 3
  
  # HTTP configuration
  http_port: 8000
  
  # Environment variables (set these in DigitalOcean dashboard)
  envs:
  - key: ENVIRONMENT
    value: production
  - key: HOST
    value: 0.0.0.0
  - key: PORT
    value: "8000"
  - key: LOG_LEVEL
    value: INFO
  - key: TELEGRAM_BOT_TOKEN
    scope: RUN_TIME
    type: SECRET
  - key: WEBHOOK_URL
    scope: RUN_TIME
    type: SECRET
  - key: WEBHOOK_SECRET
    scope: RUN_TIME
    type: SECRET
  - key: MONGODB_URI
    scope: RUN_TIME
    type: SECRET
  - key: DEEPSEEK_API_KEY
    scope: RUN_TIME
    type: SECRET
  - key: GOOGLE_CLOUD_CREDENTIALS_JSON
    scope: RUN_TIME
    type: SECRET
  - key: SECRET_KEY
    scope: RUN_TIME
    type: SECRET

# Optional: Add a database if you want to use DigitalOcean Managed Database
# databases:
# - name: mathbot-db
#   engine: MONGODB
#   version: "5"
#   size: db-s-1vcpu-1gb
